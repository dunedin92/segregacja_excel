Index: SEGREGACJA_EXCEL.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>#!/usr/bin/env python3\r\n# coding: utf-8\r\n# -*- coding: utf-8 -*-\r\nfrom PyQt5 import QtCore, QtGui, QtWidgets\r\nfrom PyQt5.QtWidgets import QApplication, QMainWindow, QFileDialog\r\nfrom excel_check import excel_check\r\nfrom qty_total_calculation import qty_total_calculation\r\nfrom txt_file_creation import txt_file_creation\r\nfrom temp_file_list import temp_file_list\r\nfrom move_files import move_files\r\nimport os\r\nimport sys\r\nimport webbrowser\r\nimport time\r\nimport subprocess\r\nimport shutil\r\n\r\n\r\nclass MyWindow(QMainWindow):\r\n    def __init__(self):\r\n        super(MyWindow, self).__init__()\r\n        self.setObjectName(\"MainWindow\")\r\n        self.resize(640, 720)\r\n        self.setTabShape(QtWidgets.QTabWidget.Rounded)\r\n        self.initUI()\r\n\r\n    def initUI(self):\r\n        self.centralwidget = QtWidgets.QWidget(self)\r\n        self.centralwidget.setObjectName(\"centralwidget\")\r\n        self.block_1 = QtWidgets.QFrame(self.centralwidget)\r\n        self.block_1.setGeometry(QtCore.QRect(10, 10, 620, 155))\r\n        self.block_1.setAccessibleName(\"\")\r\n        self.block_1.setAccessibleDescription(\"\")\r\n        self.block_1.setLocale(QtCore.QLocale(QtCore.QLocale.Polish, QtCore.QLocale.Poland))\r\n        self.block_1.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_1.setFrameShadow(QtWidgets.QFrame.Plain)\r\n        self.block_1.setLineWidth(2)\r\n        self.block_1.setObjectName(\"block_1\")\r\n        self.block_1_title = QtWidgets.QLabel(self.block_1)\r\n        self.block_1_title.setGeometry(QtCore.QRect(10, 5, 200, 20))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(18)\r\n        font.setBold(True)\r\n        font.setItalic(True)\r\n        font.setWeight(75)\r\n        self.block_1_title.setFont(font)\r\n        self.block_1_title.setObjectName(\"block_1_title\")\r\n        self.block_1_description = QtWidgets.QLabel(self.block_1)\r\n        self.block_1_description.setGeometry(QtCore.QRect(10, 35, 600, 30))\r\n        self.block_1_description.setLayoutDirection(QtCore.Qt.LeftToRight)\r\n        self.block_1_description.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_1_description.setFrameShadow(QtWidgets.QFrame.Raised)\r\n        self.block_1_description.setObjectName(\"block_1_description\")\r\n        self.bom_button = QtWidgets.QPushButton(self.block_1)\r\n        self.bom_button.setGeometry(QtCore.QRect(10, 80, 80, 25))\r\n        self.bom_button.setObjectName(\"bom_button\")\r\n        self.bom_verification_button = QtWidgets.QPushButton(self.block_1)\r\n        self.bom_verification_button.setGeometry(QtCore.QRect(10, 120, 200, 25))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(10)\r\n        font.setBold(True)\r\n        font.setWeight(75)\r\n        self.bom_verification_button.setFont(font)\r\n        self.bom_verification_button.setDefault(True)\r\n        self.bom_verification_button.setObjectName(\"bom_verification_button\")\r\n        self.line_bom_path = QtWidgets.QLineEdit(self.block_1)\r\n        self.line_bom_path.setGeometry(QtCore.QRect(90, 80, 520, 25))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setItalic(True)\r\n        font.setStyleStrategy(QtGui.QFont.PreferDefault)\r\n        self.line_bom_path.setFont(font)\r\n        self.line_bom_path.setInputMask(\"\")\r\n        self.line_bom_path.setText(\"Nie wybrano pliku.\")\r\n        self.line_bom_path.setMaxLength(32773)\r\n        self.line_bom_path.setEchoMode(QtWidgets.QLineEdit.Normal)\r\n        self.line_bom_path.setReadOnly(True)\r\n        self.line_bom_path.setObjectName(\"line_bom_path\")\r\n        self.bom_verification_info_text = QtWidgets.QLabel(self.block_1)\r\n        self.bom_verification_info_text.setGeometry(QtCore.QRect(220, 120, 390, 25))\r\n        self.bom_verification_info_text.setObjectName(\"bom_verification_info_text\")\r\n        self.block_2 = QtWidgets.QFrame(self.centralwidget)\r\n        self.block_2.setGeometry(QtCore.QRect(10, 170, 620, 120))\r\n        self.block_2.setAccessibleName(\"\")\r\n        self.block_2.setAccessibleDescription(\"\")\r\n        self.block_2.setLocale(QtCore.QLocale(QtCore.QLocale.Polish, QtCore.QLocale.Poland))\r\n        self.block_2.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_2.setFrameShadow(QtWidgets.QFrame.Plain)\r\n        self.block_2.setLineWidth(2)\r\n        self.block_2.setObjectName(\"block_2\")\r\n        self.block_2_title = QtWidgets.QLabel(self.block_2)\r\n        self.block_2_title.setGeometry(QtCore.QRect(10, 5, 200, 20))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(18)\r\n        font.setBold(True)\r\n        font.setItalic(True)\r\n        font.setWeight(75)\r\n        self.block_2_title.setFont(font)\r\n        self.block_2_title.setObjectName(\"block_2_title\")\r\n        self.block_2_description = QtWidgets.QLabel(self.block_2)\r\n        self.block_2_description.setGeometry(QtCore.QRect(10, 35, 600, 40))\r\n        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)\r\n        sizePolicy.setHorizontalStretch(0)\r\n        sizePolicy.setVerticalStretch(2)\r\n        sizePolicy.setHeightForWidth(self.block_2_description.sizePolicy().hasHeightForWidth())\r\n        self.block_2_description.setSizePolicy(sizePolicy)\r\n        self.block_2_description.setMinimumSize(QtCore.QSize(0, 30))\r\n        self.block_2_description.setLayoutDirection(QtCore.Qt.LeftToRight)\r\n        self.block_2_description.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_2_description.setFrameShadow(QtWidgets.QFrame.Raised)\r\n        self.block_2_description.setTextFormat(QtCore.Qt.AutoText)\r\n        self.block_2_description.setScaledContents(False)\r\n        self.block_2_description.setWordWrap(True)\r\n        self.block_2_description.setObjectName(\"block_2_description\")\r\n        self.qty_calculation_button = QtWidgets.QPushButton(self.block_2)\r\n        self.qty_calculation_button.setGeometry(QtCore.QRect(10, 85, 200, 23))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(10)\r\n        font.setBold(True)\r\n        font.setWeight(75)\r\n        self.qty_calculation_button.setFont(font)\r\n        self.qty_calculation_button.setDefault(True)\r\n        self.qty_calculation_button.setObjectName(\"qty_calculation_button\")\r\n        self.qty_calculation_status = QtWidgets.QLabel(self.block_2)\r\n        self.qty_calculation_status.setGeometry(QtCore.QRect(220, 85, 390, 25))\r\n        self.qty_calculation_status.setObjectName(\"qty_calculation_status\")\r\n        self.block_3 = QtWidgets.QFrame(self.centralwidget)\r\n        self.block_3.setGeometry(QtCore.QRect(10, 295, 620, 120))\r\n        self.block_3.setAccessibleName(\"\")\r\n        self.block_3.setAccessibleDescription(\"\")\r\n        self.block_3.setLocale(QtCore.QLocale(QtCore.QLocale.Polish, QtCore.QLocale.Poland))\r\n        self.block_3.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_3.setFrameShadow(QtWidgets.QFrame.Plain)\r\n        self.block_3.setLineWidth(2)\r\n        self.block_3.setObjectName(\"block_3\")\r\n        self.block_3_title = QtWidgets.QLabel(self.block_3)\r\n        self.block_3_title.setGeometry(QtCore.QRect(10, 5, 200, 20))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(18)\r\n        font.setBold(True)\r\n        font.setItalic(True)\r\n        font.setWeight(75)\r\n        self.block_3_title.setFont(font)\r\n        self.block_3_title.setObjectName(\"block_3_title\")\r\n        self.block_3_description = QtWidgets.QLabel(self.block_3)\r\n        self.block_3_description.setGeometry(QtCore.QRect(10, 35, 600, 30))\r\n        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)\r\n        sizePolicy.setHorizontalStretch(0)\r\n        sizePolicy.setVerticalStretch(0)\r\n        sizePolicy.setHeightForWidth(self.block_3_description.sizePolicy().hasHeightForWidth())\r\n        self.block_3_description.setSizePolicy(sizePolicy)\r\n        self.block_3_description.setLayoutDirection(QtCore.Qt.LeftToRight)\r\n        self.block_3_description.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_3_description.setFrameShadow(QtWidgets.QFrame.Raised)\r\n        self.block_3_description.setObjectName(\"block_3_description\")\r\n        self.button_destination_path = QtWidgets.QPushButton(self.block_3)\r\n        self.button_destination_path.setGeometry(QtCore.QRect(530, 80, 80, 25))\r\n        self.button_destination_path.setDefault(True)\r\n        self.button_destination_path.setObjectName(\"button_destination_path\")\r\n        self.line_destination_path = QtWidgets.QLineEdit(self.block_3)\r\n        self.line_destination_path.setGeometry(QtCore.QRect(10, 80, 520, 25))\r\n        self.line_destination_path.setInputMask(\"\")\r\n        self.line_destination_path.setReadOnly(False)\r\n        self.line_destination_path.setObjectName(\"line_destination_path\")\r\n        self.block_4 = QtWidgets.QFrame(self.centralwidget)\r\n        self.block_4.setGeometry(QtCore.QRect(10, 420, 620, 120))\r\n        self.block_4.setAccessibleName(\"\")\r\n        self.block_4.setAccessibleDescription(\"\")\r\n        self.block_4.setLocale(QtCore.QLocale(QtCore.QLocale.Polish, QtCore.QLocale.Poland))\r\n        self.block_4.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_4.setFrameShadow(QtWidgets.QFrame.Plain)\r\n        self.block_4.setLineWidth(2)\r\n        self.block_4.setObjectName(\"block_4\")\r\n        self.block_4_title = QtWidgets.QLabel(self.block_4)\r\n        self.block_4_title.setGeometry(QtCore.QRect(10, 5, 200, 20))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(18)\r\n        font.setBold(True)\r\n        font.setItalic(True)\r\n        font.setWeight(75)\r\n        self.block_4_title.setFont(font)\r\n        self.block_4_title.setObjectName(\"block_4_title\")\r\n        self.block_4_description = QtWidgets.QLabel(self.block_4)\r\n        self.block_4_description.setGeometry(QtCore.QRect(10, 35, 600, 30))\r\n        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)\r\n        sizePolicy.setHorizontalStretch(0)\r\n        sizePolicy.setVerticalStretch(0)\r\n        sizePolicy.setHeightForWidth(self.block_4_description.sizePolicy().hasHeightForWidth())\r\n        self.block_4_description.setSizePolicy(sizePolicy)\r\n        self.block_4_description.setLayoutDirection(QtCore.Qt.LeftToRight)\r\n        self.block_4_description.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_4_description.setFrameShadow(QtWidgets.QFrame.Raised)\r\n        self.block_4_description.setObjectName(\"block_4_description\")\r\n        self.button_source_path = QtWidgets.QPushButton(self.block_4)\r\n        self.button_source_path.setGeometry(QtCore.QRect(530, 80, 80, 25))\r\n        self.button_source_path.setDefault(True)\r\n        self.button_source_path.setObjectName(\"button_source_path\")\r\n        self.line_source_path = QtWidgets.QLineEdit(self.block_4)\r\n        self.line_source_path.setGeometry(QtCore.QRect(10, 80, 520, 25))\r\n        self.line_source_path.setInputMask(\"\")\r\n        self.line_source_path.setReadOnly(False)\r\n        self.line_source_path.setObjectName(\"line_source_path\")\r\n        self.block_5 = QtWidgets.QFrame(self.centralwidget)\r\n        self.block_5.setGeometry(QtCore.QRect(10, 545, 620, 120))\r\n        self.block_5.setAccessibleName(\"\")\r\n        self.block_5.setAccessibleDescription(\"\")\r\n        self.block_5.setLocale(QtCore.QLocale(QtCore.QLocale.Polish, QtCore.QLocale.Poland))\r\n        self.block_5.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_5.setFrameShadow(QtWidgets.QFrame.Plain)\r\n        self.block_5.setLineWidth(2)\r\n        self.block_5.setObjectName(\"block_5\")\r\n        self.block_5_title = QtWidgets.QLabel(self.block_5)\r\n        self.block_5_title.setGeometry(QtCore.QRect(10, 5, 200, 20))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(18)\r\n        font.setBold(True)\r\n        font.setItalic(True)\r\n        font.setWeight(75)\r\n        self.block_5_title.setFont(font)\r\n        self.block_5_title.setObjectName(\"block_5_title\")\r\n        self.block_5_description = QtWidgets.QLabel(self.block_5)\r\n        self.block_5_description.setGeometry(QtCore.QRect(10, 35, 600, 30))\r\n        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)\r\n        sizePolicy.setHorizontalStretch(0)\r\n        sizePolicy.setVerticalStretch(0)\r\n        sizePolicy.setHeightForWidth(self.block_5_description.sizePolicy().hasHeightForWidth())\r\n        self.block_5_description.setSizePolicy(sizePolicy)\r\n        self.block_5_description.setLayoutDirection(QtCore.Qt.LeftToRight)\r\n        self.block_5_description.setFrameShape(QtWidgets.QFrame.Panel)\r\n        self.block_5_description.setFrameShadow(QtWidgets.QFrame.Raised)\r\n        self.block_5_description.setObjectName(\"block_5_description\")\r\n        self.button_segregation = QtWidgets.QPushButton(self.block_5)\r\n        self.button_segregation.setGeometry(QtCore.QRect(10, 75, 120, 35))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(12)\r\n        font.setBold(True)\r\n        font.setWeight(75)\r\n        self.button_segregation.setFont(font)\r\n        self.button_segregation.setDefault(True)\r\n        self.button_segregation.setObjectName(\"button_segregation\")\r\n        self.end_status = QtWidgets.QLabel(self.block_5)\r\n        self.end_status.setGeometry(QtCore.QRect(130, 75, 500, 40))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(10)\r\n        font.setBold(True)\r\n        font.setWeight(75)\r\n        font.setStyleStrategy(QtGui.QFont.NoAntialias)\r\n        self.end_status.setFont(font)\r\n        self.end_status.setTextFormat(QtCore.Qt.AutoText)\r\n        self.end_status.setAlignment(QtCore.Qt.AlignLeft)\r\n        self.end_status.setWordWrap(True)\r\n        self.end_status.setObjectName(\"end_status\")\r\n        self.end_button = QtWidgets.QPushButton(self.centralwidget)\r\n        self.end_button.setGeometry(QtCore.QRect(510, 680, 120, 30))\r\n        font = QtGui.QFont()\r\n        font.setFamily(\"Century Gothic\")\r\n        font.setPointSize(10)\r\n        font.setBold(True)\r\n        font.setWeight(75)\r\n        self.end_button.setFont(font)\r\n        self.end_button.setLocale(QtCore.QLocale(QtCore.QLocale.Polish, QtCore.QLocale.Poland))\r\n        self.end_button.setDefault(True)\r\n        self.end_button.setFlat(False)\r\n        self.end_button.setObjectName(\"end_button\")\r\n        self.setCentralWidget(self.centralwidget)\r\n\r\n        # self.retranslateUi(MyWindow)\r\n        QtCore.QMetaObject.connectSlotsByName(self)\r\n\r\n        _translate = QtCore.QCoreApplication.translate\r\n        self.setWindowTitle(_translate(\"MainWindow\", \"Aplikacja Segregująca pliki BOM'u\"))\r\n        self.block_1_title.setText(_translate(\"MainWindow\", \"Krok 1\"))\r\n        self.block_1_description.setText(_translate(\"MainWindow\",\r\n                                                    \"Wybierz plik excel zawierający BOM i kliknij zweryfikuj aby sprawdzić czy jest on poprawny.\"))\r\n        self.bom_button.setText(_translate(\"MainWindow\", \"Przeglądaj\"))\r\n        self.bom_verification_button.setText(_translate(\"MainWindow\", \"Zweryfikuj Poprawność\"))\r\n        self.bom_verification_info_text.setText(_translate(\"MainWindow\", \"...\"))\r\n        self.block_2_title.setText(_translate(\"MainWindow\", \"Krok 2\"))\r\n        self.block_2_description.setText(_translate(\"MainWindow\",\r\n                                                    \"<html><head/><body><p align=\\\"justify\\\">Krok nie jest obowiązkowy. Kliknij przycisk aby program automatycznie policzył i wprowadził do arkusza Qty_Total.              Upewnij się, że plik nie jest obecnie otwarty.</p></body></html>\"))\r\n        self.qty_calculation_button.setText(_translate(\"MainWindow\", \"Policz Qty_Total\"))\r\n        self.qty_calculation_status.setText(_translate(\"MainWindow\", \"...\"))\r\n        self.block_3_title.setText(_translate(\"MainWindow\", \"Krok 3\"))\r\n        self.block_3_description.setText(_translate(\"MainWindow\",\r\n                                                    \"Podaj ściezkę do miejsca gdzie bedą kopiowane posegregowane pliki i gdzie będzie zapisana lista brakujących plików.\"))\r\n        self.button_destination_path.setText(_translate(\"MainWindow\", \"Przeglądaj\"))\r\n        self.block_4_title.setText(_translate(\"MainWindow\", \"Krok 4\"))\r\n        self.block_4_description.setText(_translate(\"MainWindow\",\r\n                                                    \"Podaj ściezkę do lokalizacji, z której będą kopiowane pliki. Program przejrzy wszystkie podfoldery tego folderu.\"))\r\n        self.button_source_path.setText(_translate(\"MainWindow\", \"Przeglądaj\"))\r\n        self.block_5_title.setText(_translate(\"MainWindow\", \"Krok 5\"))\r\n        self.block_5_description.setText(_translate(\"MainWindow\",\r\n                                                    \"Kliknij przycisk Segreguj aby posegregować pliki zgodnie z podanymi wyżej danymi.\"))\r\n        self.button_segregation.setText(_translate(\"MainWindow\", \"Segreguj\"))\r\n        self.end_status.setText(_translate(\"MainWindow\", \" \"))\r\n        self.end_button.setText(_translate(\"MainWindow\", \"Zakończ\"))\r\n\r\n        self.bom_button.clicked.connect(self.bom_button_clicked)\r\n        self.bom_verification_button.clicked.connect(self.bom_verification_button_clicked)\r\n        self.qty_calculation_button.clicked.connect(self.qty_calculation_button_clicked)\r\n        self.button_destination_path.clicked.connect(self.button_destination_path_clicked)\r\n        self.button_source_path.clicked.connect(self.button_source_path_clicked)\r\n        self.button_segregation.clicked.connect(self.button_segregation_clicked)\r\n        self.end_button.clicked.connect(self.end_button_clicked)\r\n\r\n        self.bom_path = 'null'\r\n        self.correct_bom_file_selected = False\r\n\r\n    def bom_button_clicked(self):\r\n        self.bom_path = QFileDialog.getOpenFileName(self, \"Select File Name:\", \"D:\\PROGRAMOWANIE\",\r\n                                                    \" Excel files (*.xlsx *.xls)\")\r\n        print(self.bom_path)\r\n        self.line_bom_path.setText(self.bom_path[0])\r\n        font = QtGui.QFont()\r\n        font.setItalic(False)\r\n        self.line_bom_path.setFont(font)\r\n        return self.bom_path\r\n\r\n    def bom_verification_button_clicked(self):\r\n        if self.bom_path == 'null':\r\n            self.bom_verification_info_text.setText('NIE WYBRANO ŻADNEGO PLIKU ZAWIERAJĄCEGO BOM!!!')\r\n        else:\r\n            print(self.bom_path[0])\r\n            self.path = self.bom_path[0]\r\n            try:\r\n                self.item_number, self.part_number, self.qty, self.qty_total, self.tch1, self.tch2, self.tch3, self.rysunek, self.max_row = excel_check(\r\n                    self.path)\r\n                self.bom_verification_info_text.setText('Wybrano poprawny plik BOM. Możesz przejść do kolejnego kroku.')\r\n                self.correct_bom_file_selected = True\r\n                return self.path, self.item_number, self.part_number, self.qty, self.qty_total, self.tch1, self.tch2, self.tch3, self.rysunek, self.max_row\r\n            except:\r\n                self.bom_verification_info_text.setText('Wybrany plik jest niepoprawny.')\r\n                self.correct_bom_file_selected = False\r\n\r\n    def qty_calculation_button_clicked(self):\r\n        try:\r\n            qty_total_calculation(self.path, self.item_number, self.qty, self.qty_total)\r\n            self.qty_calculation_status.setText('Ilości w kolumnie Qty_Total zostały pomyślnie policzone.')\r\n        except:\r\n            self.qty_calculation_status.setText(\r\n                \"Nie udało się policzyć wartości. Sprawdź czy plik nie jest otwary w innym programie\")\r\n\r\n    def button_destination_path_clicked(self):\r\n        self.destination_path = QFileDialog.getExistingDirectory(self, \"Select Directory\")\r\n        self.line_destination_path.setText(self.destination_path)\r\n\r\n    def button_source_path_clicked(self):\r\n        self.source_path = QFileDialog.getExistingDirectory(self, \"Select Directory\")\r\n        self.line_source_path.setText(self.source_path)\r\n\r\n    def button_segregation_clicked(self):\r\n        self.end_status.setText(\" \")\r\n        self.destination_path = self.line_destination_path.text()\r\n        self.source_path = self.line_source_path.text()\r\n        txt_file_name = \"brakujace_pliki.txt\"\r\n\r\n        if self.correct_bom_file_selected:\r\n            if os.path.exists(self.destination_path):\r\n                if os.path.exists(self.source_path):\r\n\r\n                    try:\r\n                        self.end_status.setText(\"Czekaj...\")\r\n                        self.no_file_in_source, self.modification_time = temp_file_list(self.source_path,\r\n                                                                                        self.destination_path,\r\n                                                                                        self.path, self.part_number,\r\n                                                                                        self.tch1, self.tch2, self.tch3,\r\n                                                                                        self.rysunek, self.max_row)\r\n                        self.end_status.setText(\"UKOŃCZONO TWORZENIE LISTY PLIKÓW DO KONWERSJI!!!\")\r\n                        print(self.modification_time)\r\n\r\n                        # uruchomienie programu c_program w C# ktory konwertuje pliki solida\r\n                        subprocess.call(\"solidworks_conversion_program.exe\")\r\n                        time.sleep(5)\r\n\r\n                        # petla oczekujaca na nadpisanie pliku tymczasowego 'temp_file_txt.txt'\r\n                        if self.modification_time != time.ctime(os.path.getmtime(\"temp_file_txt.txt\")):\r\n                            print('ROZPOCZYNAM PRZENOSZENIE PLIKÓW.')\r\n                            move_files(self.destination_path, self.no_file_in_source)\r\n                            os.remove(\"temp_file_txt.txt\")\r\n                        else:\r\n                            self.end_status.setText(\"Wystapił problem w trakcie konwersji plików.\")\r\n\r\n                    except:\r\n                        self.end_status.setText(\"Wystapił problem w trakcie tworzenie listy plików\")\r\n\r\n                    try:\r\n                        txt_file_creation(self.destination_path, self.no_file_in_source, txt_file_name)\r\n                        self.end_status.setText(\r\n                            \"UKOŃCZONO SEGREGACJE!!! Lista brakujących plików w pliku brakujące_pliki.txt\")\r\n                        txt_file_path = os.path.join(self.destination_path, txt_file_name)\r\n                        webbrowser.open(txt_file_path)\r\n\r\n                    except:\r\n                        self.end_status.setText(\"Wystapił problem z zapisem brakujących plików do: \" + txt_file_name)\r\n                else:\r\n                    self.end_status.setText(\"Nie wybrano ścieżki, z której mają być kopiowane pliki!\")\r\n            else:\r\n                self.end_status.setText(\"Nie wybrano ścieżki, do której mają być kopiowane pliki!\")\r\n        else:\r\n            self.end_status.setText(\"Nie wybrano BOM'u do segregacji lub wybrany plik nie został zweryfikowany.\")\r\n\r\n    def end_button_clicked(self):\r\n        sys.exit(app.exec_())\r\n\r\n\r\ndef window():\r\n    app = QApplication(sys.argv)\r\n    win = MyWindow()\r\n    win.show()\r\n    sys.exit(app.exec_())\r\n\r\n\r\nwindow()\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SEGREGACJA_EXCEL.py b/SEGREGACJA_EXCEL.py
--- a/SEGREGACJA_EXCEL.py	(revision dc61057eddd7431d611cfc2f0d5de43043535b3c)
+++ b/SEGREGACJA_EXCEL.py	(date 1631534139022)
@@ -385,7 +385,7 @@
                         if self.modification_time != time.ctime(os.path.getmtime("temp_file_txt.txt")):
                             print('ROZPOCZYNAM PRZENOSZENIE PLIKÓW.')
                             move_files(self.destination_path, self.no_file_in_source)
-                            os.remove("temp_file_txt.txt")
+                            # os.remove("temp_file_txt.txt")
                         else:
                             self.end_status.setText("Wystapił problem w trakcie konwersji plików.")
 
